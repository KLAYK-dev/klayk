# üîç Drizzle MCP - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (–î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è)

## ‚úÖ Pre-Flight Checklist

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º MCP-—Å–µ—Ä–≤–µ—Ä–∞ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —É –≤–∞—Å —î:

- [ ] Node.js >= 18 –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π
- [ ] –ü—Ä–æ–µ–∫—Ç KLAYK –∑–∞–ø—É—â–µ–Ω–∏–π (–≤—Å–µ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ)
- [ ] PostgreSQL –¥–æ—Å—Ç—É–ø–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ –∞–±–æ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ
- [ ] `DATABASE_URL` –∑–º—ñ–Ω–Ω–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- [ ] drizzle.config.ts –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π

---

## üöÄ –ö—Ä–æ–∫ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ DATABASE_URL

**–Ø–∫—â–æ —É –≤–∞—Å —â–µ –Ω–µ–º–∞—î –ë–î:**

```bash
# –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Docker —Ç–∞ PostgreSQL
# –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Prisma Postgres: https://www.prisma.io/postgres

# –¢–∏–º—á–∞—Å–æ–≤–æ (–¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è):
$env:DATABASE_URL = "postgresql://localhost:5432/klayk_dev"
```

**–Ø–∫—â–æ —É –≤–∞—Å —É–∂–µ —î PostgreSQL:**

```bash
$env:DATABASE_URL = "postgresql://user:password@localhost:5432/klayk_db"

# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:
psql $env:DATABASE_URL -c "SELECT NOW();"
```

**–ü–æ—Å—Ç—ñ–π–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–¥–æ–¥–∞—Ç–∏ —É .env):**

```bash
# packages/database/.env
DATABASE_URL=postgresql://user:password@localhost:5432/klayk_db
```

---

## üß™ –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–æ–¥—É–ª—è Drizzle

```bash
cd c:\Users\user\Desktop\klayk\packages\database

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –º–æ–¥—É–ª—å –∫–æ—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
node -e "
import('./src/index.js').then(() => {
  console.log('‚úì Drizzle ORM initialized');
  console.log('‚úì Connection pool configured');
}).catch(err => {
  console.error('‚úó Error:', err.message);
  process.exit(1);
});
"
```

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úì Drizzle ORM initialized
‚úì Connection pool configured
```

---

## üåê –ö—Ä–æ–∫ 3: –¢–µ—Å—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î

```bash
# –ü—Ä—è–º–∏–π —Ç–µ—Å—Ç –∑ postgres.js
node -e "
import postgres from 'postgres';

const sql = postgres(process.env.DATABASE_URL || 'postgresql://localhost:5432/klayk_dev');

sql\`SELECT NOW()\`
  .then(result => {
    console.log('‚úì Database connection: OK');
    console.log('‚úì Current time:', result[0]);
    process.exit(0);
  })
  .catch(err => {
    console.error('‚úó Connection failed:', err.message);
    process.exit(1);
  });
"
```

---

## üîß –ö—Ä–æ–∫ 4: –ó–∞–ø—É—Å–∫ MCP-—Å–µ—Ä–≤–µ—Ä–∞

### –í–∞—Ä—ñ–∞–Ω—Ç A: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –∑–∞–ø—É—Å–∫

```bash
cd c:\Users\user\Desktop\klayk\packages\database
npm run db:mcp
```

### –í–∞—Ä—ñ–∞–Ω—Ç B: –ó DEBUG-—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –¥–ª—è –ø–µ—Ä—à–æ–≥–æ —Ä–∞–∑—É)

```bash
npm run db:mcp:dev
```

### –í–∞—Ä—ñ–∞–Ω—Ç C: –ü—Ä—è–º–∏–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ npx

```bash
npx -y github:defrex/drizzle-mcp --config ./drizzle.config.ts
```

**–û—á—ñ–∫—É–≤–∞–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (—É console –∞–±–æ stderr):**

```
‚úì Drizzle MCP Server started
‚úì Schema loaded successfully
‚úì Tables: 14
  - users
  - products
  - orders
  - ...
‚úì Server listening on stdio
```

---

## üìä –ö—Ä–æ–∫ 5: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ

–ö–æ–ª–∏ MCP-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω–∏–π, –≤—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ç–∞–∫—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:

### 1Ô∏è‚É£ get_schema_info

```
–ó–∞–ø–∏—Ç: "–ü–æ–∫–∞–∑–∞—Ç–∏ –º–µ–Ω—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ñ users"
MCP –≤–∏–¥–∞—î: {
  table: "users",
  columns: [
    { name: "id", type: "uuid", nullable: false },
    { name: "email", type: "varchar(255)", nullable: false, unique: true },
    ...
  ],
  indexes: [...],
  foreignKeys: [...]
}
```

### 2Ô∏è‚É£ execute_query

```
–ó–∞–ø–∏—Ç: "–°–∫—ñ–ª—å–∫–∏ —é–∑–µ—Ä—ñ–≤ —É –±–∞–∑—ñ?"
MCP –≤–∏–¥–∞—î:
SELECT COUNT(*) as count FROM users;
–†–µ–∑—É–ª—å—Ç–∞—Ç: [{ count: 42 }]
```

### 3Ô∏è‚É£ generate_migration

```
–ó–∞–ø–∏—Ç: "–î–æ–¥–∞–π –ø–æ–ª–µ status –¥–æ —Ç–∞–±–ª–∏—Ü—ñ users"
MCP –≤–∏–¥–∞—î:
- –ó–≥–µ–Ω–µ—Ä—É—î —Ñ–∞–π–ª –º—ñ–≥—Ä–∞—Ü—ñ—ó
- –í–∏–∫–æ–Ω–∞—î drizzle-kit generate
- –ì–æ—Ç–æ–≤–∏–π –¥–æ db:push
```

---

## üîå –ö—Ä–æ–∫ 6: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Claude Desktop

### –ù–∞ Windows:

1. **–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥:**
   ```
   %APPDATA%\Claude\claude_desktop_config.json
   ```

2. **–î–æ–¥–∞–π—Ç–µ MCP —Å–µ—Ä–≤–µ—Ä:**
   ```json
   {
     "mcpServers": {
       "drizzle": {
         "command": "npx",
         "args": [
           "-y",
           "github:defrex/drizzle-mcp",
           "--config",
           "c:/Users/user/Desktop/klayk/packages/database/drizzle.config.ts"
         ],
         "env": {
           "DATABASE_URL": "postgresql://localhost:5432/klayk_dev"
         }
       }
     }
   }
   ```

3. **–ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ Claude Desktop** (–∑–∞–∫—Ä–∏–π—Ç–µ –ø–æ–≤–Ω—ñ—Å—Ç—é —ñ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –∑–Ω–æ–≤—É)

4. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:**
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ —ñ–∫–æ–Ω–∫—É ‚öôÔ∏è Settings
   - –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É **Developer** ‚Üí **MCP Servers**
   - –ü–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤–∏–¥—ñ–ª–µ–Ω–∏–π "drizzle" —Å–µ—Ä–≤–µ—Ä –≤ —Å—Ç–∞—Ç—É—Å—ñ **Connected** ‚úì

---

## üß© –ö—Ä–æ–∫ 7: –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ü—Ä–∏–∫–ª–∞–¥ 1: –ê–Ω–∞–ª—ñ–∑ —Å—Ö–µ–º–∏ —á–µ—Ä–µ–∑ Claude

```
You: "–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π —Ç–∞–±–ª–∏—Ü—é orders —Ç–∞ –ø–æ–∫–∞–∂–∏, —á–∏ —î —Ç–∞–º 
     —ñ–Ω–¥–µ–∫—Å–∏ –Ω–∞ principales –∫–æ–ª–æ–Ω–∫–∏ (order_number, user_id, status)"

Claude (–∑ MCP –¥–æ—Å—Ç—É–ø–æ–º):
- –í–∏–∫–æ–Ω–∞—î get_schema_info –¥–ª—è —Ç–∞–±–ª–∏—Ü—ñ orders
- –ü–æ–∫–∞–∂–µ—Ç –≤—Å—ñ –∫–æ–ª–æ–Ω–∏, —Ç–∏–ø–∏, —ñ–Ω–¥–µ–∫—Å–∏
- –î–∞—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—é: "–ü—Ä–æ–ø–æ–Ω—É—é –¥–æ–¥–∞—Ç–∏ —ñ–Ω–¥–µ–∫—Å –Ω–∞ (user_id, status) 
                        –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤"
```

### –ü—Ä–∏–∫–ª–∞–¥ 2: –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

```
You: "–°–∫—ñ–ª—å–∫–∏ –∑–∞–º–æ–≤–ª–µ–Ω—å –º–∞—é—Ç—å status='pending' –±—ñ–ª—å—à–µ —è–∫ 7 –¥–Ω—ñ–≤?
      –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –Ω–∞—à–∏—Ö –≤–æ—Ä–æ–Ω–∫–∞—Ö"

Claude (–∑ MCP –¥–æ—Å—Ç—É–ø–æ–º):
- –í–∏–∫–æ–Ω–∞—î SQL –∑–∞–ø–∏—Ç —á–µ—Ä–µ–∑ execute_query
- –ü–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "23 –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–¥–∞–≤–Ω–µ–Ω–æ –æ—á—ñ–∫—É—î"
- –ú–æ–∂–µ—Ç –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è: "–ü—Ä–æ–ø–æ–Ω—É—é –º—ñ–≥—Ä–∞—Ü—ñ—é –¥–ª—è –¥–æ–¥–∞–Ω–Ω—è –ø–æ–ª—è 
                     pending_since_days –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É"
```

### –ü—Ä–∏–∫–ª–∞–¥ 3: –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–∞ –º—ñ–≥—Ä–∞—Ü—ñ—è

```
You: "–î–æ–¥–∞–π —Ç–∞–±–ª–∏—Ü—é –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ API –∑–∞–ø–∏—Ç—ñ–≤"

Claude (–∑ MCP –¥–æ—Å—Ç—É–ø–æ–º):
- –ó–≥–µ–Ω–µ—Ä—É—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ñ:
  - id, timestamp, endpoint, method
  - status_code, error_message, stack_trace
  - request_body, response_time
- –í–∏–∫–æ–Ω–∞—î drizzle-kit generate
- –ó–∞–ø—Ä–æ–ø–æ–Ω—É—î: "db:push –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è"
```

---

## üêõ Debugging & Troubleshooting

### ‚ùå –ü–æ–º–∏–ª–∫–∞: "DATABASE_URL is not set"

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –∑–º—ñ–Ω–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞:
echo $env:DATABASE_URL

# –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤—Ä—É—á–Ω—É:
$env:DATABASE_URL = "postgresql://localhost:5432/klayk_dev"

# –ê–±–æ –¥–æ–¥–∞–π—Ç–µ —É .env —Ñ–∞–π–ª:
# DATABASE_URL=postgresql://localhost:5432/klayk_dev
```

### ‚ùå –ü–æ–º–∏–ª–∫–∞: "Cannot connect to database"

```bash
# 1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ PostgreSQL –∑–∞–ø—É—â–µ–Ω–∞:
psql --version

# 2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä—è–¥–æ–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:
psql "postgresql://localhost:5432/klayk_dev" -c "SELECT 1"

# 3. –Ø–∫—â–æ –Ω–µ –º–∞—î—Ç—å—Å—è –ë–î:
createdb klayk_dev
```

### ‚ùå –ü–æ–º–∏–ª–∫–∞: "Schema loading timeout"

```bash
# –ú–æ–∂–µ –±—É—Ç–∏, —â–æ —Ç–∞–±–ª–∏—Ü—ñ –Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω—ñ. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –º—ñ–≥—Ä–∞—Ü—ñ—ó:
npm run db:push

# –ê–±–æ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ç–∞–±–ª–∏—Ü—å:
psql $env:DATABASE_URL -c "\dt"
```

### ‚ùå Claude –Ω–µ –±–∞—á–∏—Ç MCP —Å–µ—Ä–≤–µ—Ä

```bash
# 1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å JSON —É claude_desktop_config.json
# 2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —à–ª—è—Ö–∏ –∞–±—Å–æ–ª—é—Ç–Ω—ñ (–∑ –¥–∏—Å–∫–æ–º C:/)
# 3. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ Claude Desktop –ø–æ–≤–Ω—ñ—Å—Ç—é
# 4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –Ω–µ–º–∞—î —ñ–Ω—à–∏—Ö MCP —Å–µ—Ä–≤–µ—Ä—ñ–≤, —â–æ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—É—é—Ç—å
```

---

## üìà Performance Tips

### –î–ª—è –≤–∞—à–æ–≥–æ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—É:

1. **–ö–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤**
   ```
   –ö–ª–æ–¥ –º–æ–∂–µ: "–ó–∞–ø–∞–º'—è—Ç–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ü—å–æ–≥–æ –∑–∞–ø–∏—Ç—É –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö 5 —Ö–≤"
   ```

2. **–Ü–Ω–¥–µ–∫—Å—É–≤–∞–Ω–Ω—è –≥–∞—Ä—è—á–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤**
   ```
   "–Ø–∫—ñ –∑–∞–ø–∏—Ç–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –Ω–∞–π—á–∞—Å—Ç—ñ—à–µ? –î–∞–≤–∞–π –¥–æ–¥–∞–º–æ —ñ–Ω–¥–µ–∫—Å–∏"
   ```

3. **–ü–∞—Ä—Ç–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –≤–µ–ª–∏–∫–∏—Ö —Ç–∞–±–ª–∏—Ü—å**
   ```
   –î–ª—è audit_logs —Ç–∞ analytics –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ø–∞—Ä—Ç–∏—Ü—ñ—é–≤–∞–Ω–Ω—è –ø–æ –¥–∞—Ç–∞–º
   ```

---

## üìö –î–æ–¥–∞—Ç–∫–æ–≤–æ

- **MCP Protocol Spec:** https://modelcontextprotocol.io
- **Drizzle ORM Docs:** https://orm.drizzle.team
- **defrex/drizzle-mcp GitHub:** https://github.com/defrex/drizzle-mcp

---

## ‚ú® –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è

–ö–æ–ª–∏ MCP-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω–∏–π —ñ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ Claude Desktop, –≤–∏ –∑–º–æ–∂–µ—Ç–µ:

‚úÖ –ó–∞–ø–∏—Ç–∞—Ç–∏ AI –ø—Ä–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±—É–¥—å-—è–∫–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
‚úÖ –ü–æ–ø—Ä–æ—Å–∏—Ç–∏ AI –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ
‚úÖ –°–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ñ –∑–∞–ø–∏—Ç–∏
‚úÖ –î–µ–±–∞–≥–∏—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ –≤ –ë–î —Ä–∞–∑–æ–º –∑ AI
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —Ä—É—Ç–∏–Ω–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ –ë–î

**–ì–æ—Ç–æ–≤–æ! üéâ**
